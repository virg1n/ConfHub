<!-- templates/view_repository.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ repo.name }} by {{ author }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <h1>Repository: {{ repo.name }}</h1>
    <p>Author: {{ author }}</p>
    <p>Created on: {{ repo.created_time | datetimeformat }}</p>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <ul class="flashes">
          {% for category, message in messages %}
            <li class="{{ category }}">{{ message }}</li>
          {% endfor %}
        </ul>
      {% endif %}
    {% endwith %}

    <h2>Description</h2>
    <form action="{{ url_for('view_repository', author=author, repo_name=repo.name) }}" method="post">
        <input type="hidden" name="action" value="update_description">
        <textarea name="description" rows="4" cols="50">{{ description }}</textarea><br>
        <input type="submit" value="Update Description">
    </form>

    <h2>Files</h2>
    <ul>
        {% for file in files %}
            <li>
                {{ file.filename }} - Uploaded on {{ file.upload_time | datetimeformat }}
                <a href="{{ url_for('download_file', file_id=file.id) }}">Download</a>
                <a href="{{ url_for('delete_file', file_id=file.id) }}" onclick="return confirm('Are you sure you want to delete this file?');">Delete</a>
            </li>
        {% else %}
            <li>No files found in this repository.</li>
        {% endfor %}
    </ul>

    <h3>Add New Files</h3>
    <form action="{{ url_for('view_repository', author=author, repo_name=repo.name) }}" method="post" enctype="multipart/form-data">
        <input type="hidden" name="action" value="add_files">
        <input type="file" name="files" multiple><br><br>
        <input type="submit" value="Add Files">
    </form>

    <br>
    <a href="{{ url_for('view_repositories') }}">Back to Repositories</a>
</body>
</html>
